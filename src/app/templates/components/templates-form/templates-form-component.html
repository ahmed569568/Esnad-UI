<div
	ngClass.gt-md="form-spacing lg"
	[ngClass]="{ headerSmallSize: headerSmallSize }"
>
	<form fxFlex fxLayout="column" class="core-form-style" [formGroup]="form">
		<div fxFlex fxLayout class="page_heading">
			<span class="title"> </span>
		</div>

		<div fxFlex fxLayout>
			<mat-card fxFlex>
				<mat-card-content>
					<div fxFlex="" fxLayout="column" class="d-flex flex-items-center">
						<div fxFlex="" class="default-form">
							<div
								*ngFor="
									let groups of service.formInputsCategorized | pairs; let groupI = index; trackBy: trackByFn
								"
							>
								<!-- default inputs Group start  aka (no tab group or tabs )-->
								<ng-container *ngIf="groups[0] === 'defaultGroup'">
									<ng-container
										*ngFor="let tab of groups[1] | pairs; trackBy: trackByFn"
									>
										<ng-container
											*ngFor="let section of tab[1] | pairs; trackBy: trackByFn"
										>
											<div class="form-section defaultSection">
												<div
													class="form-section-title"
													*ngIf="section[0] !== 'defaultSection'"
												>
													{{ section[0] | translate }}
												</div>
												<div
													class="form-section-content"
													fxFlex=""
													fxLayout="row"
													fxLayoutGap="30px"
												>
													<ng-container
														*ngFor="let field of section[1]; trackBy: trackByFn"
													>
														<ng-container
															*ngIf="field?.form && fieldShowConditions(field)"
														>
															<app-core-form-content
																[cid]="service.cid"
																[service]="service"
																[field]="field"
																[form]="form"
																(showHideChanges)="showHideChanges($event)"
																[isEdit]="isEdit"
																[isClone]="isClone"
																[isSubmitted]="isSubmitted"
																[fxFlex.lg]="getInputGridSize(field.form.grid.lg, '30px')"
																[fxFlex.md]="getInputGridSize(field.form.grid.md, '30px')"
																[fxFlex.sm]="getInputGridSize(field.form.grid.sm, '30px')"
															>
															</app-core-form-content>
														</ng-container>
													</ng-container>
												</div>
											</div>
										</ng-container>
									</ng-container>
								</ng-container>
								<!-- default inputs Group start -->

								<!-- Tabs Groups start -->
								<ng-container *ngIf="groups[0] !== 'defaultGroup'">
									<mat-accordion>
										<mat-expansion-panel [ngClass]="groups[0]">
											<mat-expansion-panel-header>
												<mat-panel-title>
													{{groupI | json }} {{ form.get('step_' + groupI +
													'_name').value ? form.get('step_' + groupI +
													'_name').value : ('templates.step_placeholder' |
													translate) }}
												</mat-panel-title>
											</mat-expansion-panel-header>

											<div
												*ngFor="let tab of groups[1] | pairs; let stepI = index;
														trackBy: trackByFn"
											>
												<div class="pt-5">
													<ng-container
														*ngFor="
														let section of tab[1] | pairs; let sectionI = index;
														trackBy: trackByFn
													"
													>
														<div
															class="form-section"
															[ngClass]="{'cardStyle' : section[0] !== 'defaultSection'}"
														>
															<div
																class="form-section-title"
																*ngIf="section[0] !== 'defaultSection'"
															>
																{{ section[0] | translate }}
															</div>
															<div
																class="form-section-content"
																fxFlex=""
																fxLayout="row"
																fxLayoutGap="30px"
															>
																<ng-container *ngFor="let field of section[1]">
																	<ng-container
																		*ngIf="
																		field?.form && fieldShowConditions(field)
																	"
																	>
																		<app-core-form-content
																			[cid]="service.cid"
																			[service]="service"
																			[field]="field"
																			[form]="form"
																			(showHideChanges)="showHideChanges($event)"
																			[isEdit]="isEdit"
																			[isClone]="isClone"
																			[isSubmitted]="isSubmitted"
																			[fxFlex.lg]="getInputGridSize(field.form.grid.lg, '30px')"
																			[fxFlex.md]="getInputGridSize(field.form.grid.md, '30px')"
																			[fxFlex.sm]="getInputGridSize(field.form.grid.sm, '30px')"
																		>
																		</app-core-form-content>
																	</ng-container>
																</ng-container>
															</div>
														</div>
													</ng-container>
												</div>
											</div>
										</mat-expansion-panel>
									</mat-accordion>
								</ng-container>
								<!-- Tabs Groups end -->
							</div>
						</div>
					</div>
				</mat-card-content>
				<mat-card-footer></mat-card-footer>
			</mat-card>
		</div>

		<div fxFlex fxLayout>
			<mat-card fxFlex>
				<mat-card-content>
					<button
						class="add_stage_button"
						mat-stroked-button
						(click)="createStage()"
					>
						<mat-icon
							class="mdi-icon"
							svgIcon="playlist-plus"
							[attr.size]="'22px'"
						></mat-icon>
						add new stage
					</button>
				</mat-card-content>
			</mat-card>
		</div>

		<div fxFlex fxLayout class="page_footer">
			<span></span>
			<app-form-footer
				(submit)="formSubmission()"
				(cancel)="cancelFormSubmission()"
				[form]="form"
			></app-form-footer>
		</div>
	</form>
</div>
